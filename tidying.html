<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' https://webr.r-wasm.org; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' https://webr.r-wasm.org https://repo.r-wasm.org; worker-src 'self' blob: https://webr.r-wasm.org; object-src 'none'; base-uri 'self'; frame-ancestors 'none';">
    <title>Module 3: The Dragonfly</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script type="module" src="script.js"></script>
</head>
<body>
<nav><a href="index.html">&larr; Back to Town</a></nav>
<header>
    <h1>Module 3: Tidying the Kitchen</h1>
    <p>"Sookie, the data is everywhere! We need to pivot!"</p>
</header>

<div class="concept-card">
    <h2>1. What is "Tidy" Data?</h2>
    <div class="lesson-text">
        <p>R is picky. It demands <strong>Tidy Data</strong>. Think of it like Sookie's kitchen AFTER a cleanup.</p>
        <ul>
            <li><strong>Rule 1:</strong> Each variable gets its own column.</li>
            <li><strong>Rule 2:</strong> Each observation gets its own row.</li>
        </ul>
        <p>If you have a column for "Monday" and a column for "Tuesday", that is untidy. "Day" should be a column, and "Monday" should be a value inside it.</p>
    </div>
</div>

<div class="concept-card">
    <h2>2. Pivot Longer (Wide to Long)</h2>
    <div class="lesson-text">
        <p>Michel's reservation spreadsheet is "Wide" (Dates are columns like "Mon", "Tue"). We need to melt it down so R can read it.</p>

        <div class="lesson-box-large">
            <strong>The Syntax:</strong>
            <pre class="pre-clean">pivot_longer(data, cols = c(Old1, Old2), names_to = "NewName", values_to = "NewValue")</pre>
        </div>

        <p><strong>Example:</strong> Melting a "Grades" table:</p>
        <pre><code>grades |> pivot_longer(cols = c(Math, English), names_to = "Subject", values_to = "Score")</code></pre>
    </div>

    <div class="instruction-box">
        <h3>üç≥ Mission: Tidy the Pantry</h3>
        <ul class="instruction-list">
            <li>Use <code>pivot_longer()</code> on <code>kitchen</code>.</li>
            <li>We want to combine columns <code>Monday</code> and <code>Tuesday</code>.</li>
            <li>Call the new name column <code>"Day"</code> and the value column <code>"Eggs"</code>.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="kitchen |> ...">
                <button class="check-btn"
                        data-answer='kitchen |> pivot_longer(cols = c(Monday, Tuesday), names_to = "Day", values_to = "Eggs")'
                        data-output="  Dish      Day        Eggs<br>1 Omelette  Monday     50<br>2 Omelette  Tuesday    40">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card">
    <h2>3. Pivot Wider (Long to Wide)</h2>
    <div class="lesson-text">
        <p>Sometimes you need to do the reverse! Michel wants a printed schedule for the lobby. This requires spreading rows back into columns.</p>

        <div class="lesson-box-large">
            <strong>The Syntax:</strong>
            <pre class="pre-clean">pivot_wider(data, names_from = "ColumnA", values_from = "ColumnB")</pre>
        </div>
    </div>

    <div class="instruction-box">
        <h3>üç≥ Mission: Set the Tables</h3>
        <ul class="instruction-list">
            <li>Take <code>long_data</code>.</li>
            <li>Use <code>pivot_wider()</code>.</li>
            <li>Take column names from <code>"Day"</code>.</li>
            <li>Take values from <code>"Eggs"</code>.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn"
                        data-answer='long_data |> pivot_wider(names_from = "Day", values_from = "Eggs")'
                        data-output="  Dish      Monday  Tuesday<br>1 Omelette  50      45">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>
</body>
</html>