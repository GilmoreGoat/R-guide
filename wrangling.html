<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self' 'unsafe-eval' https://webr.r-wasm.org; style-src 'self' 'unsafe-inline'; img-src 'self' data:; connect-src 'self' https://webr.r-wasm.org https://repo.r-wasm.org; worker-src 'self' blob: https://webr.r-wasm.org; object-src 'none'; base-uri 'self'; frame-ancestors 'none';">
    <title>Module 2: Luke's Diner</title>
    <link rel="stylesheet" href="style.css">
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <script type="module" src="script.js"></script>
</head>
<body>
<nav><a href="index.html">&larr; Back to Town</a></nav>
<header>
    <h1>Module 2: Wrangling at Luke's</h1>
    <p>"I can't filter my feelings, but I can filter this data."</p>
</header>

<div class="concept-card">
    <h2>1. The Data Frame (The Menu)</h2>
    <p>A Data Frame is a table. Rows are observations, columns are variables.</p>
    <p>Use <code>glimpse(diner_data)</code> to peek at it.</p>
</div>

<div class="concept-card">
    <h2>2. Select vs Pull (The Receipt)</h2>
    <div class="lesson-text">
        <p><strong>Critical Concept:</strong></p>
        <ul>
            <li><code>select()</code>: Returns a <strong>Table</strong> (Data Frame). Use this to create a smaller dataset.</li>
            <li><code>pull()</code>: Returns a <strong>Vector</strong> (List of numbers). Use this if you want to do math on it immediately.</li>
        </ul>
        <div class="lesson-box">
            <strong>Syntax:</strong> <code>data |> select(col1, col2)</code> OR <code>data |> pull(col1)</code>
        </div>
    </div>
    <div class="instruction-box">
        <h3>üçî Mission: Calculate Profits</h3>
        <ul class="instruction-list">
            <li>Extract the <code>price</code> column from <code>menu</code> using <code>pull()</code> so we can sum it up later.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn" data-answer="menu |> pull(price)" data-output="[1] 12.00  6.50  3.00">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card">
    <h2>3. The Dollar Sign ($)</h2>
    <div class="lesson-text">
        <p>The <code>$</code> is a shortcut for <code>pull()</code>. It grabs a specific column from a dataframe.</p>
        <div class="lesson-box">
            <strong>Syntax:</strong> <code>dataframe$column_name</code>
        </div>
        <p><em>Think:</em> <code>Luke's_Wallet$Cash</code>.</p>
    </div>
    <div class="instruction-box">
        <h3>üçî Mission: Grab the Tips</h3>
        <ul class="instruction-list">
            <li>Extract the <code>tips</code> column from <code>orders</code> using <code>$</code>.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn" data-answer="orders$tips" data-output="[1] 2.00 5.00 0.00">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card">
    <h2>4. Filter (Rows)</h2>
    <div class="lesson-text">
        <p>Luke wants to kick out annoying customers. <code>filter()</code> keeps rows where the condition is TRUE.</p>
        <div class="lesson-box">
            <strong>Syntax:</strong> <code>data |> filter(column == "Value")</code>
        </div>
        <p><strong>Note:</strong> Use <code>==</code> for "is equal to", and <code>!=</code> for "is NOT equal to".</p>
    </div>
    <div class="instruction-box">
        <h3>üçî Mission: Ban Taylor</h3>
        <ul class="instruction-list">
            <li>Filter <code>customers</code> where <code>name</code> is NOT equal to <code>"Taylor"</code>.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn" data-answer='customers |> filter(name != "Taylor")' data-output="  name      status<br>1 Lorelai   VIP<br>2 Rory      VIP">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card">
    <h2>5. Arrange (Sorting)</h2>
    <div class="lesson-text">
        <p>Sort the menu. Default is Ascending (Low to High).</p>
        <div class="lesson-box">
            <strong>Syntax:</strong> <code>data |> arrange(column)</code><br>
            <strong>Reverse:</strong> <code>data |> arrange(desc(column))</code>
        </div>
    </div>
    <div class="instruction-box">
        <h3>üçî Mission: Most Expensive First</h3>
        <ul class="instruction-list">
            <li>Arrange <code>menu</code> by <code>price</code> in descending order.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn" data-answer="menu |> arrange(desc(price))" data-output="  item           price<br>1 Lobster_Roll   25.00">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card">
    <h2>6. Mutate (Special Orders)</h2>
    <div class="lesson-text">
        <p>Lorelai never orders off the menu; she changes it. <code>mutate()</code> creates new columns based on math from old ones.</p>
        <div class="lesson-box">
            <strong>Syntax:</strong> <code>data |> mutate(new_col = old_col * 2)</code>
        </div>
    </div>
    <div class="instruction-box">
        <h3>üçî Mission: Inflation Hits</h3>
        <ul class="instruction-list">
            <li>Create a column <code>new_price</code> in <code>menu</code>.</li>
            <li>Set it equal to <code>price * 1.10</code>.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn" data-answer="menu |> mutate(new_price = price * 1.10)" data-output="  item    price  new_price<br>1 Burger  12.00  13.20">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card">
    <h2>7. Inspecting the Crowd</h2>
    <p>Who is actually here? Use <code>unique()</code> for a list, or <code>table()</code> for counts.</p>
    <div class="instruction-box">
        <h3>üçî Mission: Count the Townies</h3>
        <ul class="instruction-list">
            <li>Run <code>table()</code> on the <code>role</code> column inside <code>townies</code>.</li>
            <li>Remember to use <code>$</code> to grab the column!</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn" data-answer="table(townies$role)" data-output="Owner: 1  Mechanic: 1  Selectman: 1">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

<div class="concept-card border-autumn-orange">
    <h2>8. Group By & Summarise (The Power Move)</h2>
    <div class="lesson-text">
        <p>This splits your data into groups (like "Townie" vs. "Tourist"), calculates a stat for each, and gives you a summary table.</p>
        <div class="lesson-box">
            <strong>Syntax:</strong><br>
            <code>data |> group_by(category) |> summarise(avg = mean(values))</code>
        </div>
    </div>
    <div class="instruction-box">
        <h3>üçî Mission: Average Tips by Server</h3>
        <ul class="instruction-list">
            <li>Take <code>orders</code>.</li>
            <li>Group by <code>server</code>.</li>
            <li>Summarise to create <code>avg_tip</code> which is the <code>mean(tip)</code>.</li>
        </ul>
    </div>
    <div class="editor-container">
        <div class="editor-header">script.R</div>
        <div class="editor-body">
            <div class="code-input-line">
                <span class="prompt">></span>
                <input type="text" class="editor-input input-code" placeholder="...">
                <button class="check-btn"
                        data-answer="orders |> group_by(server) |> summarise(avg_tip = mean(tip))"
                        data-output="  server  avg_tip<br>1 Luke    0.50<br>2 Lane    5.00">Run</button>
            </div>
        </div>
        <div class="console-output feedback"></div>
    </div>
</div>

</body>
</html>